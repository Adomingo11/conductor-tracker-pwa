<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Control - Conductor Tracker</title>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Conductor Tracker">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4fd1c7">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/assets/manifest-BE3rfUmX.json">
    
    <!-- Icons -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM0ZmQxYzciLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWExZjJlIj4KPHA+PHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+CjwvcD4KPC9zdmc+Cjwvc3ZnPg==">
    <link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM0ZmQxYzciLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSIjMWExZjJlIj4KPHA+PHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIi8+CjwvcD4KPC9zdmc+Cjwvc3ZnPg==">
  <script type="module" crossorigin src="/assets/index-DIpcv2ey.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/vendor-2jmnBxhj.js">
  <link rel="stylesheet" crossorigin href="/assets/index-D79Ca2BW.css">
</head>
<body>
    <div id="app" class="app-container">
        <!-- Navigation will be injected by Navigation component -->
        
        <main class="main-content">
            <div id="dashboard-view" class="view active">
                <div class="welcome-section">
                    <h1>Bienvenido al Panel de Control</h1>
                    <p>Aqu√≠ tienes un resumen de tu actividad total.</p>
                </div>
                
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-circle">
                            <span class="metric-value" id="total-km">0</span>
                            <span class="metric-unit">km</span>
                        </div>
                        <h3>Km Totales</h3>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-circle">
                            <span class="metric-value" id="total-carreras">0</span>
                            <span class="metric-unit">carreras</span>
                        </div>
                        <h3>Carreras Totales</h3>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-circle">
                            <span class="metric-value" id="total-ganancias">0</span>
                            <span class="metric-unit">‚Ç¨</span>
                        </div>
                        <h3>Ganancia Neta Total</h3>
                    </div>
                </div>
                
                <button class="btn-primary" id="registrar-nuevo-dia">Registrar Nuevo D√≠a</button>
            </div>

            <div id="registro-view" class="view">
                <h2>Registro Diario</h2>
                <form id="registro-form" class="registro-form">
                    <div class="form-section">
                        <label for="fecha-registro">Fecha del Registro</label>
                        <input type="date" id="fecha-registro" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="km-recorridos">Km Recorridos</label>
                            <input type="number" id="km-recorridos" min="0" step="0.1" value="0">
                        </div>
                        <div class="form-group">
                            <label for="num-carreras">N¬∫ de Carreras Totales</label>
                            <input type="number" id="num-carreras" min="0" value="0">
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Uber</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="uber-app">Uber App</label>
                                <input type="number" id="uber-app" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                            <div class="form-group">
                                <label for="uber-propinas">Propinas Uber</label>
                                <input type="number" id="uber-propinas" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>FreeNow</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="freenow-app">App</label>
                                <input type="number" id="freenow-app" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                            <div class="form-group">
                                <label for="freenow-tarjeta">Tarjeta</label>
                                <input type="number" id="freenow-tarjeta" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="freenow-efectivo">Efectivo</label>
                                <input type="number" id="freenow-efectivo" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                            <div class="form-group">
                                <label for="freenow-propinas">Propinas</label>
                                <input type="number" id="freenow-propinas" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Taxi Convencional</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="taxi-tarjeta">Tarjeta</label>
                                <input type="number" id="taxi-tarjeta" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                            <div class="form-group">
                                <label for="taxi-efectivo">Efectivo</label>
                                <input type="number" id="taxi-efectivo" min="0" step="0.01" value="0">
                                <span class="currency">‚Ç¨</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>Gastos</h3>
                        <div class="form-group">
                            <label for="combustible">Combustible</label>
                            <input type="number" id="combustible" min="0" step="0.01" value="0">
                            <span class="currency">‚Ç¨</span>
                        </div>
                    </div>

                    <div class="calculation-preview">
                        <h4>Vista Previa del C√°lculo</h4>
                        <div class="calc-line">Ganancia Bruta: <span id="ganancia-bruta">0.00</span>‚Ç¨</div>
                        <div class="calc-line">- Comisi√≥n Veh√≠culo (52%): <span id="comision-vehiculo">0.00</span>‚Ç¨</div>
                        <div class="calc-line">- Costo Kilometraje: <span id="costo-km">0.00</span>‚Ç¨</div>
                        <div class="calc-line">- Comisi√≥n FreeNow Efectivo (6%): <span id="comision-freenow">0.00</span>‚Ç¨</div>
                        <div class="calc-line">+ Gastos Combustible: <span id="gastos-combustible">0.00</span>‚Ç¨</div>
                        <div class="calc-total">Ganancia Neta: <span id="ganancia-neta">0.00</span>‚Ç¨</div>
                    </div>

                    <button type="submit" class="btn-primary">Guardar y Calcular D√≠a</button>
                </form>
            </div>

            <div id="historial-view" class="view">
                <h2>üìã Historial de Registros</h2>
                <p>Consulta y filtra todos tus registros diarios.</p>

                <div class="historial-filters">
                    <div class="filter-section">
                        <h4>üîç Filtros R√°pidos</h4>
                        <div class="quick-filters">
                            <button class="quick-filter-btn" data-filter="today">Hoy</button>
                            <button class="quick-filter-btn" data-filter="week">Esta Semana</button>
                            <button class="quick-filter-btn" data-filter="month">Este Mes</button>
                            <button class="quick-filter-btn" data-filter="last30">√öltimos 30 d√≠as</button>
                            <button class="quick-filter-btn" data-filter="all">Todos</button>
                        </div>
                    </div>
                    
                    <div class="filter-section">
                        <h4>üìÖ Rango Personalizado</h4>
                        <div class="filter-row">
                            <div class="form-group">
                                <label for="fecha-desde">Desde:</label>
                                <input type="date" id="fecha-desde">
                            </div>
                            <div class="form-group">
                                <label for="fecha-hasta">Hasta:</label>
                                <input type="date" id="fecha-hasta">
                            </div>
                            <div class="filter-actions">
                                <button id="aplicar-filtros" class="btn-primary">Filtrar</button>
                                <button id="limpiar-filtros" class="btn-secondary">Limpiar</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="filter-results" id="filter-results" style="display: none;">
                        <span id="results-count">0 registros encontrados</span>
                    </div>
                </div>

                <div id="historial-content" class="historial-content">
                    <div class="historial-placeholder">
                        <p>Selecciona un rango de fechas o deja vac√≠o para ver todos los registros.</p>
                    </div>
                </div>
            </div>

            <div id="informes-view" class="view">
                <h2>Informes de Actividad</h2>
                <p>Analiza tus ganancias y rendimiento por semana o mes.</p>
                
                <div class="filter-tabs">
                    <button class="tab-btn active" data-period="semanal">Semanal</button>
                    <button class="tab-btn" data-period="mensual">Mensual</button>
                </div>

                <div class="informes-content">
                    <div class="no-data">
                        <p>No hay datos registrados para mostrar informes.</p>
                        <p>Empieza por a√±adir un registro diario.</p>
                    </div>
                </div>
            </div>

            <div id="dashboard-visual-view" class="view">
                <h2>üìä Dashboard Visual</h2>
                <p>An√°lisis gr√°fico de tendencias y m√©tricas de rendimiento.</p>

                <!-- Loading indicator -->
                <div id="dashboard-visual-loading" class="loading-container" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Cargando gr√°ficos...</p>
                </div>

                <!-- Period selector -->
                <div class="period-selector">
                    <h3>Per√≠odo de An√°lisis</h3>
                    <div class="period-buttons">
                        <button class="period-btn" data-period="7">7 d√≠as</button>
                        <button class="period-btn active" data-period="30">30 d√≠as</button>
                        <button class="period-btn" data-period="90">3 meses</button>
                        <button class="period-btn" data-period="180">6 meses</button>
                    </div>
                    <div class="chart-controls">
                        <button id="refresh-charts" class="btn-secondary">üîÑ Actualizar</button>
                        <button id="reset-zoom" class="btn-secondary">üîç Resetear Zoom</button>
                    </div>
                </div>

                <!-- No data message -->
                <div id="dashboard-visual-no-data" class="no-data-message" style="display: none;">
                    <div class="no-data-icon">üìä</div>
                    <h3>No hay datos para mostrar</h3>
                    <p>Registra algunos d√≠as de actividad para ver gr√°ficos y tendencias.</p>
                    <button class="btn-primary" onclick="window.app.navigateTo('registro')">Registrar Nuevo D√≠a</button>
                </div>

                <!-- Main content -->
                <div id="dashboard-visual-content">
                    <!-- Performance metrics -->
                    <div class="metrics-section">
                        <h3>M√©tricas de Rendimiento</h3>
                        <div class="performance-metrics">
                            <div class="metric-card">
                                <div class="metric-header">
                                    <span class="metric-title">Ganancia por Carrera</span>
                                    <div id="earnings-trend" class="trend-indicator">‚Üí 0%</div>
                                </div>
                                <div class="metric-value-container">
                                    <span class="metric-value" id="avg-earnings-per-ride">0.00</span>
                                    <span class="metric-unit">‚Ç¨/carrera</span>
                                </div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-header">
                                    <span class="metric-title">Ganancia por Km</span>
                                    <div id="km-trend" class="trend-indicator">‚Üí 0%</div>
                                </div>
                                <div class="metric-value-container">
                                    <span class="metric-value" id="avg-earnings-per-km">0.00</span>
                                    <span class="metric-unit">‚Ç¨/km</span>
                                </div>
                            </div>
                            
                            <div class="metric-card">
                                <div class="metric-header">
                                    <span class="metric-title">Carreras por D√≠a</span>
                                    <div id="rides-trend" class="trend-indicator">‚Üí 0%</div>
                                </div>
                                <div class="metric-value-container">
                                    <span class="metric-value" id="avg-rides-per-day">0.00</span>
                                    <span class="metric-unit">carreras/d√≠a</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts container -->
                    <div id="charts-container" class="charts-container">
                        <!-- Temporal trends section -->
                        <div class="charts-section">
                            <h3>Tendencias Temporales</h3>
                            <div class="charts-grid">
                                <div class="chart-container">
                                    <canvas id="earnings-chart"></canvas>
                                </div>
                                <div class="chart-container">
                                    <canvas id="kilometers-chart"></canvas>
                                </div>
                                <div class="chart-container">
                                    <canvas id="rides-chart"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Platform distribution section -->
                        <div class="charts-section">
                            <h3>Distribuci√≥n por Plataforma</h3>
                            <div id="period-info" style="display: none;"></div>
                            <div class="charts-grid platform-charts">
                                <div class="chart-container">
                                    <canvas id="platform-bar-chart"></canvas>
                                    <div class="chart-interactive-hint">Haz clic para detalles</div>
                                </div>
                                <div class="chart-container">
                                    <canvas id="platform-pie-chart"></canvas>
                                    <div class="chart-interactive-hint">Haz clic para detalles</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="ai-view" class="view">
                <h2>ü§ñ Asistente IA</h2>
                <p>An√°lisis inteligente, predicciones y chat personalizado para optimizar tus ganancias.</p>

                <div id="ai-loading" class="ai-loading" style="display: none;">Procesando...</div>
                
                <div class="ai-status-section">
                    <div id="ai-status" class="ai-status inactive">‚ùå IA No Configurada</div>
                </div>

                <div id="ai-config-section" class="ai-config-section">
                    <h3>üîß Configuraci√≥n de IA</h3>
                    <p>Para usar las funciones de IA, necesitas una API Key de Google AI Studio (gratuita).</p>
                    <div class="config-steps">
                        <ol>
                            <li>Ve a <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></li>
                            <li>Crea una API Key gratuita</li>
                            <li>P√©gala aqu√≠ abajo</li>
                        </ol>
                    </div>
                    <div class="form-group">
                        <label for="ai-api-key">API Key de Google AI Studio:</label>
                        <input type="password" id="ai-api-key" placeholder="Pega tu API Key aqu√≠">
                    </div>
                    <button id="configure-ai" class="btn-primary">Configurar IA</button>
                </div>

                <div id="ai-features-section" class="ai-features-section" style="display: none;">
                    <div class="ai-tabs">
                        <button class="ai-tab-btn active" data-tab="analysis">üìä An√°lisis</button>
                        <button class="ai-tab-btn" data-tab="predictions">üîÆ Predicciones</button>
                        <button class="ai-tab-btn" data-tab="chat">üí¨ Chat IA</button>
                    </div>

                    <div id="ai-analysis-tab" class="ai-tab-content active">
                        <div id="ai-analysis-container" class="ai-analysis-container">
                            <div class="analysis-placeholder">
                                <p>Haz clic en "Analizar Datos" para obtener insights inteligentes sobre tu actividad.</p>
                                <button id="analyze-data" class="btn-primary">üìä Analizar Datos</button>
                            </div>
                        </div>
                    </div>

                    <div id="ai-predictions-tab" class="ai-tab-content">
                        <div id="ai-predictions-container" class="ai-predictions-container">
                            <div class="predictions-placeholder">
                                <p>Genera predicciones basadas en tus patrones de trabajo.</p>
                                <button id="generate-predictions" class="btn-primary">üîÆ Generar Predicciones</button>
                            </div>
                        </div>
                    </div>

                    <div id="ai-chat-tab" class="ai-tab-content">
                        <div class="ai-chat-container">
                            <div id="chat-messages" class="chat-messages">
                                <div class="chat-message assistant">
                                    <div class="message-content">
                                        <div class="message-text">¬°Hola! Soy tu asistente de IA. Puedes preguntarme sobre tus ganancias, tendencias, o pedirme consejos para mejorar tus ingresos. ¬øEn qu√© puedo ayudarte?</div>
                                    </div>
                                </div>
                            </div>
                            <form id="chat-form" class="chat-form">
                                <input type="text" id="chat-input" placeholder="Preg√∫ntame sobre tus ganancias, tendencias, consejos..." required>
                                <button type="submit" class="btn-primary">Enviar</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div id="ajustes-view" class="view">
                <h2>Ajustes</h2>
                <p>Personaliza tu perfil y planifica tus d√≠as no laborables.</p>

                <div class="ajustes-section">
                    <h3>Perfil del Conductor</h3>
                    <div class="form-group">
                        <label for="conductor-nombre">Nombre</label>
                        <input type="text" id="conductor-nombre" placeholder="Tu nombre">
                    </div>
                    <div class="form-group">
                        <label for="conductor-apellido">Apellido</label>
                        <input type="text" id="conductor-apellido" placeholder="Tu apellido">
                    </div>
                    <button class="btn-primary" id="guardar-perfil">Guardar Perfil</button>
                </div>

                <div class="ajustes-section">
                    <h3>D√≠a Libre Semanal</h3>
                    <select id="dia-libre">
                        <option value="">Ninguno</option>
                        <option value="lunes">Lunes</option>
                        <option value="martes">Martes</option>
                        <option value="miercoles">Mi√©rcoles</option>
                        <option value="jueves">Jueves</option>
                        <option value="viernes">Viernes</option>
                        <option value="sabado">S√°bado</option>
                        <option value="domingo">Domingo</option>
                    </select>
                    <div class="button-group">
                        <button class="btn-primary" id="guardar-dia-libre">Guardar D√≠a Libre</button>
                        <button class="btn-danger" id="limpiar-dia-libre">Limpiar D√≠a Libre</button>
                    </div>
                </div>

                <div class="ajustes-section">
                    <h3>Per√≠odo de Vacaciones</h3>
                    <div class="form-group">
                        <label for="vacaciones-inicio">Inicio de Vacaciones</label>
                        <input type="date" id="vacaciones-inicio">
                    </div>
                    <div class="form-group">
                        <label for="vacaciones-fin">Fin de Vacaciones</label>
                        <input type="date" id="vacaciones-fin">
                    </div>
                    <div class="button-group">
                        <button class="btn-primary" id="guardar-vacaciones">Guardar Vacaciones</button>
                        <button class="btn-danger" id="limpiar-vacaciones">Limpiar Vacaciones</button>
                    </div>
                </div>

                <div class="ajustes-section">
                    <h3>Exportar/Importar Datos</h3>
                    <p>Haz copias de seguridad de tus datos o importa informaci√≥n desde otro dispositivo.</p>
                    
                    <div class="export-import-section">
                        <div class="export-section">
                            <h4>üì§ Exportar Datos</h4>
                            <p>Descarga todos tus registros, configuraci√≥n y perfil en un archivo JSON.</p>
                            <button class="btn-primary" id="export-data">Exportar Datos</button>
                        </div>
                        
                        <div class="import-section">
                            <h4>üì• Importar Datos</h4>
                            <p>Selecciona un archivo JSON previamente exportado para restaurar tus datos.</p>
                            <input type="file" id="import-file" accept=".json" style="display: none;">
                            <button class="btn-secondary" id="select-import-file">Seleccionar Archivo</button>
                            
                            <!-- Import preview -->
                            <div id="import-preview" class="import-preview" style="display: none;">
                                <h5>Vista Previa de Importaci√≥n</h5>
                                <div id="import-preview-content"></div>
                                <div class="import-actions">
                                    <button class="btn-primary" id="confirm-import">Confirmar Importaci√≥n</button>
                                    <button class="btn-secondary" id="cancel-import">Cancelar</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ajustes-section">
                    <h3>Estad√≠sticas de Edici√≥n</h3>
                    <div id="edit-statistics-container">
                        <!-- Edit statistics will be populated by JavaScript -->
                    </div>
                </div>

                <div class="ajustes-section">
                    <h3>Resumen de Configuraci√≥n Actual</h3>
                    
                    <div class="profile-summary config-summary" style="display: none;">
                        <!-- Profile info will be populated by JavaScript -->
                    </div>
                    
                    <div class="config-summary">
                        <p><strong>D√≠a Libre Semanal:</strong> <span id="resumen-dia-libre">Ninguno configurado</span></p>
                        <p><strong>Per√≠odo de Vacaciones:</strong> <span id="resumen-vacaciones">Ninguno configurado</span></p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <div id="notification" class="notification hidden"></div>

</body>
</html>